<!doctype html>
<html lang="en" dir="ltr" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>BashaLanka ‚Äî Learn Sinhala</title>

    <!-- App identity -->
    <meta name="description" content="BashaLanka ‚Äî learn Sinhala with quick, game-like lessons." />
    <link rel="icon" href="icons/icon-192.png" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />
    <link rel="manifest" href="manifest.webmanifest" />

    <!-- Fonts (system stack for speed; swap later if desired) -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- PWA / Theming -->
    <meta name="theme-color" content="#0f1720" />
  </head>

  <body>
    <!-- Mobile tab bar (visible on small screens) -->
    <nav class="tabbar" aria-label="Primary">
      <button class="tabbar__btn is-active" data-route="home" aria-current="page">
        <span class="ico" aria-hidden="true">üè†</span>
        <span class="lbl">Home</span>
      </button>
      <button class="tabbar__btn" data-route="quests">
        <span class="ico" aria-hidden="true">üó∫Ô∏è</span>
        <span class="lbl">Quests</span>
      </button>
      <button class="tabbar__btn" data-route="profile">
        <span class="ico" aria-hidden="true">üë§</span>
        <span class="lbl">Profile</span>
      </button>
    </nav>

    <!-- Top header (desktop HUD; collapses on mobile) -->
    <header class="topbar" role="banner">
      <div class="topbar__left">
        <img src="assets/logo.svg" alt="" class="logo" />
        <a class="brand" href="#" data-route="home">BashaLanka</a>
      </div>

      <div class="topbar__center">
        <button class="btn btn--ghost" data-action="toggle-theme" aria-pressed="false" title="Toggle theme">
          <span class="only-icons" aria-hidden="true">üåô</span>
          <span class="sr-only">Toggle theme</span>
        </button>
      </div>

      <div class="topbar__right" aria-label="Player HUD">
        <div class="hud">
          <div class="hud__item" title="Hearts">
            <span class="ico" aria-hidden="true">‚ù§Ô∏è</span>
            <span id="hearts" class="hud__val" aria-live="polite">5</span>
          </div>
          <div class="hud__item" title="XP">
            <span class="ico" aria-hidden="true">‚≠ê</span>
            <span id="xp" class="hud__val" aria-live="polite">0</span>
          </div>
          <div class="hud__item" title="Streak">
            <span class="ico" aria-hidden="true">üî•</span>
            <span id="streak" class="hud__val" aria-live="polite">0</span>
          </div>
        </div>
        <button class="btn btn--ghost only-mobile" data-action="toggle-sidebar" aria-expanded="false" aria-controls="sidebar">
          ‚ò∞ <span class="sr-only">Menu</span>
        </button>
      </div>
    </header>

    <!-- App layout: sidebar (collapsible) + main content -->
    <div class="layout">
      <aside id="sidebar" class="sidebar" aria-label="Sections">
        <h2 class="sidebar__title">Course</h2>
        <nav class="sidebar__nav">
          <button class="chip is-active" data-section="1">Section 1</button>
          <button class="chip" data-section="2">Section 2</button>
          <button class="chip" data-section="3">Section 3</button>
        </nav>

        <div class="card card--muted promo">
          <h3 class="card__title">Daily Goal</h3>
          <p>Earn 10+ XP today to keep your streak alive üî•</p>
          <button class="btn btn--primary" data-action="start-lesson">Start</button>
        </div>
      </aside>

      <main id="app" class="main" role="main">
        <!-- HOME VIEW -->
        <section id="view-home" class="view is-active" aria-labelledby="home-title">
          <div class="hero">
            <div>
              <h1 id="home-title" class="hero__title">Section 1 ‚Äî Foundations</h1>
              <p class="hero__subtitle">Work through units to unlock the next path checkpoint.</p>
            </div>
            <div class="hero__cta">
              <button class="btn btn--primary" data-action="continue">Continue</button>
              <button class="btn btn--ghost" data-action="practice">Practice</button>
            </div>
          </div>

          <!-- Path grid; auto-rearranges for mobile via CSS grid -->
          <div id="pathGrid" class="path-grid" aria-live="polite">
            <!-- nodes are rendered by app.js from data/course.index.json -->
          </div>

          <!-- Checkpoint -->
          <div class="checkpoint" role="group" aria-label="Checkpoint">
            <div class="checkpoint__line" aria-hidden="true"></div>
            <button class="checkpoint__btn" data-action="checkpoint" title="Checkpoint test">üéØ</button>
            <div class="checkpoint__line" aria-hidden="true"></div>
          </div>

          <!-- More units (lazy loaded) -->
          <h2 class="section-title">Next up</h2>
          <div id="moreGrid" class="path-grid path-grid--compact"></div>
        </section>

        <!-- QUESTS VIEW (placeholder) -->
        <section id="view-quests" class="view" aria-labelledby="quests-title">
          <h1 id="quests-title" class="section-title">Quests</h1>
          <div class="card-list" id="questsList"></div>
        </section>

        <!-- PROFILE VIEW (placeholder) -->
        <section id="view-profile" class="view" aria-labelledby="profile-title">
          <h1 id="profile-title" class="section-title">Profile</h1>
          <div class="profile">
            <div class="card">
              <h3 class="card__title">Your stats</h3>
              <ul class="stats">
                <li><strong id="stat-streak">0</strong> day streak</li>
                <li><strong id="stat-xp">0</strong> XP total</li>
                <li><strong id="stat-crown">0</strong> crowns</li>
              </ul>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Toasts -->
    <div class="toasts" aria-live="assertive" aria-atomic="true"></div>

    <!-- Scripts -->
    <script src="app.js" defer></script>
    <script>
      // Register SW (optional ‚Äî safe to leave if served over file://; will no-op)
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js').catch(() => {});
        });
      }
    </script>

    <!-- Accessibility helpers -->
    <span class="sr-only" id="announce"></span>
  </body>
</html>
